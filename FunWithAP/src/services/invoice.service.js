(function() {
  'use strict';

  angular.module('AP')
  .service('InvoiceService', InvoiceService);

  InvoiceService.$inject = ['$http', '$q', '$filter', 'UserService', 'AccountsService', '$timeout'];
  function InvoiceService($http, $q, $filter, UserService, AccountsService, $timeout) {
    var invoices = this;
    const Status = {
      DRAFT: 0,
      SUBMITTED: 1,
      PENDINGDIRECTOR: 2,
      PENDINGEDMS: 3,
      APPROVED: 4,
      PROCESSING: 5,
      PENDINGDOWNLOAD: 10,
      DOWNLOADFAILED: 20,
      PAID: 8,
      DELETED: 6
    };

    var fakeData = {data:[{"InvoiceId":1,"UserId":3,"CostCenter":"110100","UserRef":null,"InvoiceDate":"2015-10-02T00:00:00","SubmittedDate":null,"Status":8,"UserComment":"abc","ApprComment":"","AcctComment":"def","PrivComment":"ghi","ApprUserId":-20,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":3,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$2,000.00","SpareField2":null,"SpareField3":"{\"110100\":\"-$131,198.20:-$96,525.96\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":0.0100,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":null,"VendorId":"BHAJAG","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":"2016-09-01T00:00:00","InvoiceDrillBackURL":"http://google.com","PaymentDrillBackURL":"http://apple.com"},{"InvoiceId":2,"UserId":3,"CostCenter":"252020","UserRef":null,"InvoiceDate":"2015-10-12T00:00:00","SubmittedDate":"2015-10-16T00:00:00","Status":3,"UserComment":"What do you think?","ApprComment":"Not what I was thinking","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":"U8sJKGXN0ggCAAAAAAAAAA==","SpareField1":"$20.00","SpareField2":null,"SpareField3":"{}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":true,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":20.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"00002","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":3,"UserId":3,"CostCenter":"110100","UserRef":null,"InvoiceDate":"2015-10-21T00:00:00","SubmittedDate":"2016-09-07T00:00:00","Status":3,"UserComment":"Me too\nBob","ApprComment":"123You are my friend.  I am trying to help you.<br/>One more time","AcctComment":"Finance testing","PrivComment":"","ApprUserId":2,"Locked":true,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$1,000.00","SpareField2":null,"SpareField3":"{\"110100\":\"-$102,028.72:-$66,020.69\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":1000.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"STECAN","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":4,"UserId":3,"CostCenter":"103560","UserRef":null,"InvoiceDate":"2015-10-20T00:00:00","SubmittedDate":"2015-10-26T00:00:00","Status":1,"UserComment":"What're you going to do?","ApprComment":"My name is Rod","AcctComment":"","PrivComment":"","ApprUserId":114,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":"Xcm4rLna0ggEAAAAAAAAAA==","SpareField1":"$300.00","SpareField2":null,"SpareField3":"{}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":true,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":300.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"Invoice #1","VendorId":"DHAAVT","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":5,"UserId":3,"CostCenter":"123001","UserRef":null,"InvoiceDate":"2015-10-20T00:00:00","SubmittedDate":"2015-10-23T00:00:00","Status":1,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":572,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":"Vg8BzaDm0ggFAAAAAAAAAA==","SpareField1":"$45.67","SpareField2":null,"SpareField3":"{\"123000\":\"-$175,420.18:-$104,531.57\",\"123001\":\"-$58,900.00:-$577.15\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"USD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":45.6700,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"sub","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":10004,"UserId":3,"CostCenter":"212020","UserRef":null,"InvoiceDate":"2015-10-25T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"testing","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":"{\"212020\":\"$0.00:$0.00\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":0.0100,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"old","VendorId":"old","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":10005,"UserId":2,"CostCenter":"110100","UserRef":null,"InvoiceDate":"2015-10-22T00:00:00","SubmittedDate":"2015-10-28T00:00:00","Status":1,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"c","ApprUserId":3,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":"8yV1zJ7m0ggVJwAAAAAAAA==","SpareField1":"$300.00","SpareField2":null,"SpareField3":"{\"110100\":\"-$68,369.15:-$52,382.40\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":true,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":300.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":10006,"UserId":3,"CostCenter":"120200","UserRef":null,"InvoiceDate":"2015-10-26T00:00:00","SubmittedDate":"2016-02-03T00:00:00","Status":1,"UserComment":"New","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":104,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$400.00","SpareField2":null,"SpareField3":"{\"120200\":\"$0.00:-$1,315.12\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":400.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"New","VendorId":"STACOR","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":10007,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2015-10-26T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":"{}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":0.0100,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"ABCPRI","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":10008,"UserId":3,"CostCenter":"650554","UserRef":null,"InvoiceDate":"2015-10-24T00:00:00","SubmittedDate":"2016-04-28T00:00:00","Status":1,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":293,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$2,000.00","SpareField2":null,"SpareField3":"{\"650554\":\"$0.00:$0.00\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":2000.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"payto","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":10009,"UserId":3,"CostCenter":"110100","UserRef":null,"InvoiceDate":"2015-10-24T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"This is a testing2","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":2,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":"{}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":0.0000,"GST":43.2200,"HST":20.0000,"TotalAmount":400.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"5","VendorId":"AMECOM","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":10010,"UserId":3,"CostCenter":"110120","UserRef":null,"InvoiceDate":"2016-04-12T00:00:00","SubmittedDate":"2016-04-27T00:00:00","Status":1,"UserComment":"yes, really sure","ApprComment":"really, REALLY sure???","AcctComment":"","PrivComment":"","ApprUserId":114,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":"T/BKuaDm0ggaJwAAAAAAAA==","SpareField1":"$155.00","SpareField2":null,"SpareField3":"{\"110100\":\"-$332,365.51:-$272,233.80\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":16.0000,"GST":15.0000,"HST":14.0000,"TotalAmount":155.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"18","VendorId":"AutoSave","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":10011,"UserId":3,"CostCenter":"101100","UserRef":null,"InvoiceDate":"2015-10-12T00:00:00","SubmittedDate":"2015-10-26T00:00:00","Status":6,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":232,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":"eo9urhbe0ggbJwAAAAAAAA==","SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":9.0000,"GST":8.0000,"HST":7.0000,"TotalAmount":600.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"11","VendorId":"Besterrer","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":20005,"UserId":428,"CostCenter":"108120","UserRef":null,"InvoiceDate":"2015-10-20T00:00:00","SubmittedDate":"2015-10-27T00:00:00","Status":1,"UserComment":"This is a user comment.  Special instructions.  And there are a multi-plethora of them, aren't ther?","ApprComment":"...and approver's response","AcctComment":"","PrivComment":"","ApprUserId":3,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$315.00","SpareField2":null,"SpareField3":"{\"108120\":\"-$80,263.58:-$60,878.16\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":true,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":315.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"Super 8 Motel","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":30005,"UserId":276,"CostCenter":"110100","UserRef":null,"InvoiceDate":"2015-10-27T00:00:00","SubmittedDate":"2015-10-28T00:00:00","Status":1,"UserComment":"","ApprComment":"ytutyuyuyjkjkj","AcctComment":"What do you mean??, abc","PrivComment":"","ApprUserId":3,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":5,"Year":2016,"Changed":true,"Department":true,"Token":null,"SpareField1":"$150.00","SpareField2":null,"SpareField3":"{\"110100\":\"-$68,369.15:-$52,382.40\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":150.0000,"Company":"GAIN","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"GULNAT","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":30006,"UserId":276,"CostCenter":"123003","UserRef":null,"InvoiceDate":"2015-10-27T00:00:00","SubmittedDate":"2015-10-28T00:00:00","Status":1,"UserComment":"","ApprComment":"","AcctComment":"Please write your descriptions in English. 6","PrivComment":"","ApprUserId":3,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":"pljbkbXf0gg2dQAAAAAAAA==","SpareField1":"$300.00","SpareField2":null,"SpareField3":"{\"123003\":\"-$8,330.00:-$15,066.78\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":true,"Currency":"USD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":300.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"4","VendorId":"AMECOM","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":30007,"UserId":304,"CostCenter":"202700","UserRef":null,"InvoiceDate":"2015-10-15T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":"{}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":4.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"BIGVAI $US","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40007,"UserId":336,"CostCenter":"","UserRef":null,"InvoiceDate":"2015-11-03T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":0.0500,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40008,"UserId":3,"CostCenter":"123000","UserRef":null,"InvoiceDate":"2016-02-10T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":40.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40009,"UserId":3,"CostCenter":"123000","UserRef":null,"InvoiceDate":"2016-02-11T00:00:00","SubmittedDate":"2016-02-26T00:00:00","Status":6,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":46.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40010,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-02-10T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":454.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40011,"UserId":3,"CostCenter":"110100","UserRef":null,"InvoiceDate":"2015-11-11T00:00:00","SubmittedDate":"2016-04-22T00:00:00","Status":3,"UserComment":"Okay, it's done","ApprComment":"Please choose another account","AcctComment":"","PrivComment":"","ApprUserId":2,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$545.99","SpareField2":null,"SpareField3":"{\"110100\":\"-$332,365.51:-$272,233.80\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":true,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":545.9900,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"DHAAVT","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40012,"UserId":3,"CostCenter":"330000","UserRef":null,"InvoiceDate":"2016-02-10T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":185,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":1.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"4","VendorId":"AMECOM","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40013,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-02-01T00:00:00","SubmittedDate":"2016-02-25T00:00:00","Status":6,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":44.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40014,"UserId":3,"CostCenter":"110120","UserRef":null,"InvoiceDate":"2016-02-18T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"testing","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":276,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":31.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"BUCAAR","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40015,"UserId":3,"CostCenter":"123003","UserRef":null,"InvoiceDate":"2016-02-02T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":478,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":"SQUMNY7K0whPnAAAAAAAAA==","SpareField1":null,"SpareField2":null,"SpareField3":"{\"123003\":\"-$12,495.00:-$15,226.47\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"USD","PST":null,"GST":null,"HST":null,"TotalAmount":45.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"allsha","VendorId":"ALLSHA","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40016,"UserId":3,"CostCenter":"123000","UserRef":null,"InvoiceDate":"2016-02-02T00:00:00","SubmittedDate":"2016-02-29T00:00:00","Status":4,"UserComment":"this is a tests","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":1649,"Locked":true,"PortalId":0,"ApprDate":"2016-02-29T00:00:00","ProcDate":null,"ProcUserId":3,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$20.00","SpareField2":null,"SpareField3":"{\"123000\":\"-$333,040.35:-$234,375.73\"}","SpareField4":"chq/eft","SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"USD","PST":null,"GST":null,"HST":null,"TotalAmount":20.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40017,"UserId":428,"CostCenter":"195000","UserRef":null,"InvoiceDate":"2016-02-09T00:00:00","SubmittedDate":"2016-02-26T00:00:00","Status":10,"UserComment":"","ApprComment":"","AcctComment":"Test comment for me out","PrivComment":"PRIVATE","ApprUserId":-20,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":"2016-09-21T00:00:00","ProcUserId":3,"Period":null,"Year":null,"Changed":true,"Department":true,"Token":null,"SpareField1":"$45.00","SpareField2":null,"SpareField3":"{}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":true,"Currency":"CAD","PST":null,"GST":0.0000,"HST":0.0000,"TotalAmount":45.0000,"Company":"PTC","PostingDate":"2016-09-21T00:00:00","BatchId":"100916bnONLINE","Reference":"Test Currency","InvoiceNo":"","VendorId":"ALDANC","RemitToAddress":"CHQ","VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40018,"UserId":373,"CostCenter":"195000","UserRef":null,"InvoiceDate":"2016-02-03T00:00:00","SubmittedDate":"2016-02-26T00:00:00","Status":10,"UserComment":"","ApprComment":"","AcctComment":"I know these two","PrivComment":"","ApprUserId":373,"Locked":false,"PortalId":0,"ApprDate":"2016-02-26T00:00:00","ProcDate":"2016-09-20T00:00:00","ProcUserId":2,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$51.00","SpareField2":null,"SpareField3":"{\"195000\":\"-$5,880.47:-$13,064.93\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"USD","PST":null,"GST":0.0000,"HST":0.0000,"TotalAmount":51.0000,"Company":"PTC","PostingDate":"2016-09-20T00:00:00","BatchId":"","Reference":"","InvoiceNo":"","VendorId":"AIAUSA US$","RemitToAddress":"CHQ US","VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":40019,"UserId":428,"CostCenter":"220440","UserRef":null,"InvoiceDate":"2016-02-10T00:00:00","SubmittedDate":"2016-02-26T00:00:00","Status":10,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":-20,"Locked":true,"PortalId":0,"ApprDate":null,"ProcDate":"2016-04-21T00:00:00","ProcUserId":3,"Period":null,"Year":null,"Changed":true,"Department":true,"Token":null,"SpareField1":"$40.00","SpareField2":null,"SpareField3":"{}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":null,"GST":2.0000,"HST":1.0000,"TotalAmount":40.0000,"Company":"TPTC","PostingDate":"2016-04-21T00:00:00","BatchId":"100916bnONLINE","Reference":"AP-NESJOD","InvoiceNo":"","VendorId":"NESBRE","RemitToAddress":"EFTCAD","VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":50008,"UserId":3,"CostCenter":"108120","UserRef":null,"InvoiceDate":"2016-04-06T00:00:00","SubmittedDate":"2016-10-24T00:00:00","Status":1,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":3739,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$24.00","SpareField2":null,"SpareField3":"{\"108120\":\"-$160,222.15:-$140,679.44\"}","SpareField4":"chq/eft","SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"USD","PST":null,"GST":null,"HST":null,"TotalAmount":24.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"ACCTRA US$","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":50009,"UserId":3,"CostCenter":"123000","UserRef":null,"InvoiceDate":"2016-04-01T00:00:00","SubmittedDate":"2016-08-04T00:00:00","Status":6,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":"{\"101100\":\"-$524,380.03:-$381,928.64\",\"103080\":\"-$14,079.25:-$9,758.79\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":12.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"ALBAAR","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":50010,"UserId":232,"CostCenter":"101100","UserRef":null,"InvoiceDate":"2015-12-09T00:00:00","SubmittedDate":"2016-04-22T00:00:00","Status":3,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":232,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$4.00","SpareField2":null,"SpareField3":"{\"101100\":\"-$483,684.21:-$362,826.53\"}","SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":4.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":50011,"UserId":3,"CostCenter":"110100","UserRef":null,"InvoiceDate":"2016-05-25T00:00:00","SubmittedDate":"2016-08-04T00:00:00","Status":6,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":-20,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":0.0100,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"00001","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":50012,"UserId":3,"CostCenter":"103560","UserRef":null,"InvoiceDate":"2016-06-02T00:00:00","SubmittedDate":"2016-08-03T00:00:00","Status":6,"UserComment":"What're you going to do?","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":551,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$300.00","SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":0.0000,"GST":0.0000,"HST":0.0000,"TotalAmount":300.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"DHAAVT","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":50013,"UserId":3,"CostCenter":"123000","UserRef":null,"InvoiceDate":"2016-06-19T00:00:00","SubmittedDate":"2016-08-03T00:00:00","Status":6,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":551,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":231.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"SANSUI","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":50014,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-06-21T00:00:00","SubmittedDate":"2016-08-03T00:00:00","Status":6,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":0.0200,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":50015,"UserId":3,"CostCenter":"123000","UserRef":null,"InvoiceDate":"2016-06-01T00:00:00","SubmittedDate":"2016-08-03T00:00:00","Status":6,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":551,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":40.0000,"Company":"","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":50016,"UserId":354,"CostCenter":"195000","UserRef":null,"InvoiceDate":"2016-08-08T00:00:00","SubmittedDate":"2016-08-10T00:00:00","Status":5,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":354,"Locked":true,"PortalId":0,"ApprDate":"2016-08-10T00:00:00","ProcDate":"2016-09-23T00:00:00","ProcUserId":3,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":"$25.00","SpareField2":null,"SpareField3":"{\"195000\":\"$0.00:$27,811.82\"}","SpareField4":"cheque","SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"USD","PST":null,"GST":0.0000,"HST":0.0000,"TotalAmount":25.0000,"Company":"PTC","PostingDate":"2016-09-23T00:00:00","BatchId":"100916bnONLINE","Reference":"","InvoiceNo":"abcd","VendorId":"INGINT US$","RemitToAddress":"CHQ","VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":60016,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-08-24T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"abcdef","ApprComment":"","AcctComment":"test","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":4.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"Beta","VendorId":"BECELI","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":60017,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-08-10T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"abcd","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":4.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"allsha","VendorId":"ALLSHA","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":60018,"UserId":3,"CostCenter":"123000","UserRef":null,"InvoiceDate":"2016-08-16T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"Test","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":3.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"allsha2","VendorId":"ALLSHA","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70016,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-09-13T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":24.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70017,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-09-15T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":2.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"bosnia","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70018,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-09-15T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":4.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70019,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-09-15T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":45.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70020,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-09-15T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":545.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70021,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-09-15T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":44.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70022,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-09-15T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"USD","PST":null,"GST":null,"HST":null,"TotalAmount":456.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"ACCTRA US$","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70023,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-09-14T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"USD","PST":null,"GST":null,"HST":null,"TotalAmount":24.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"AIAUSA US$","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70024,"UserId":3,"CostCenter":"123000","UserRef":null,"InvoiceDate":"2016-09-15T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":478,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":"amex","SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"USD","PST":null,"GST":null,"HST":null,"TotalAmount":45.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"AUSKEV US$","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":70025,"UserId":3,"CostCenter":"110100","UserRef":null,"InvoiceDate":"2016-09-16T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":2,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":"chq/eft","SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":400000.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"Bob the builder","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":80017,"UserId":276,"CostCenter":"698270","UserRef":null,"InvoiceDate":"2016-09-14T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":535,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":null,"SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"CAD","PST":null,"GST":null,"HST":null,"TotalAmount":1198.0900,"Company":"GAIN","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"INV0005590","VendorId":"FROEAM","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":80018,"UserId":3,"CostCenter":"110100","UserRef":null,"InvoiceDate":"2016-09-22T00:00:00","SubmittedDate":"2016-10-24T00:00:00","Status":1,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":114,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$54.00","SpareField2":null,"SpareField3":"{\"110100\":\"-$135,688.29:-$118,863.76\"}","SpareField4":"chq/eft","SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":54.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"bob","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":80019,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-10-13T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":"chq/eft","SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":-2.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"Negative","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":80020,"UserId":373,"CostCenter":"195000","UserRef":null,"InvoiceDate":"2016-10-19T00:00:00","SubmittedDate":"2016-10-25T00:00:00","Status":4,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":232,"Locked":true,"PortalId":0,"ApprDate":"2016-10-25T00:00:00","ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":true,"Token":null,"SpareField1":"$3.00","SpareField2":null,"SpareField3":"{\"195000\":\"-$28,363.08:-$20,542.37\"}","SpareField4":"chq/eft","SpareField5":"External ","Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":false,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":3.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"Attatchment","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null},{"InvoiceId":80021,"UserId":3,"CostCenter":"","UserRef":null,"InvoiceDate":"2016-10-26T00:00:00","SubmittedDate":null,"Status":0,"UserComment":"","ApprComment":"","AcctComment":"","PrivComment":"","ApprUserId":null,"Locked":false,"PortalId":0,"ApprDate":null,"ProcDate":null,"ProcUserId":null,"Period":null,"Year":null,"Changed":false,"Department":false,"Token":null,"SpareField1":null,"SpareField2":null,"SpareField3":null,"SpareField4":"chq/eft","SpareField5":null,"Error":false,"ErrorMessage":null,"DownloadDate":null,"MoreInfoRequested":null,"Currency":"","PST":null,"GST":null,"HST":null,"TotalAmount":6.0000,"Company":"PTC","PostingDate":null,"BatchId":null,"Reference":null,"InvoiceNo":"","VendorId":"","RemitToAddress":null,"VoucherNumber":null,"ChequeNumber":null,"PaymentDate":null,"InvoiceDrillBackURL":null,"PaymentDrillBackURL":null}]};
    var fakeLines = {data:[{InvoiceId:1},{InvoiceId:1},{InvoiceId:1}]};

    invoices.getInvoice = function(id) {
      var deferred = $q.defer();
      $timeout(function() {
        var result = fakeData.data.filter(function(item) {return item.InvoiceId==id});
        if (result.length>0) deferred.resolve({data:result[0]});
        else deferred.resolve({data:null});
      }, 800);
      return deferred.promise;
    }

    invoices.getInvoiceLines = function(id) {
      var deferred = $q.defer();
      $timeout(function() {
        deferred.resolve({data:fakeLines.data.filter(function(item) {return item.InvoiceId==id})});
      }, 800);
      return deferred.promise;
    }

    invoices.getAllInvoices = function() {
      var deferred = $q.defer();
      $timeout(function () {
        deferred.resolve(fakeData);
      }, 800);
      return deferred.promise;
    }

    invoices.getMyInvoices = function() {
      var deferred = $q.defer();
      $timeout(function () {
        deferred.resolve({data:fakeData.data.filter(function(item) {return item.UserId==3})});
      }, 800);
      return deferred.promise;
    }

    invoices.getInvoicesAwaitingMyApproval = function() {
      var deferred = $q.defer();
      $timeout(function () {
        deferred.resolve({data:fakeData.data.filter(function(item) {return item.Status==Status.SUBMITTED && item.ApprUserId==2})});
      }, 800);
      return deferred.promise;
    }

    invoices.getInvoicesForMyAccounts = function() {
      var deferred = $q.defer();
      $q.all([
        AccountsService.myAccounts(),
        invoices.getAllInvoices()
      ]).then(function(response) {
        var accounts = $filter('orderBy')(response[0].data);
        var items = response[1].data;
        var tree = [];
        for (var i in accounts) {
          tree.push({title:accounts[i], items:items.filter(function(item) {return item.CostCenter==accounts[i]})})
        }
        deferred.resolve({data:tree});
      });
      return deferred.promise;
    }

    invoices.search = function(term) {
      // Returns a flat list of items which the current user, may or may-not have access to view.
      // Search by username, approvername, invoiceId, costCenterId, comments, ApprComments, or AcctComments
      var deferred = $q.defer();
      var term = term.toLowerCase();
      $timeout(function() {
        deferred.resolve({data:fakeData.data.filter(function(item) {
          return item.InvoiceId && item.InvoiceId.toString().toLowerCase().indexOf(term)>=0
          || item.UserId && UserService.getDisplayname(item.UserId).toLowerCase().indexOf(term)>=0
          || item.ApprUserId && UserService.getDisplayname(item.ApprUserId).toLowerCase().indexOf(term)>=0
          || item.VendorId && item.VendorId.toLowerCase().indexOf(term)>=0
          || item.CostCenter && item.CostCenter.toLowerCase().indexOf(term)>=0
          || item.comment && item.comment.toLowerCase().indexOf(term)>=0
          || item.ApprComment && item.ApprComment.toLowerCase().indexOf(term)>=0
          || item.AcctComment && item.AcctComment.toLowerCase().indexOf(term)>=0})})
      }, 200);
      return deferred.promise
    }

    invoices.getDraftInvoices = function(list) {
      return list.filter(function(inv) {
        return inv.Status==Status.DRAFT
      });
    }
    invoices.getSubmittedInvoices = function(list) {
      return list.filter(function(inv) {
        return (inv.Status==Status.SUBMITTED
              || inv.Status==Status.PENDINGDIRECTOR
              || inv.Status==Status.PENDINGEDMS)
      })
    }
    invoices.getProcessingInvoices = function(list) {
      return list.filter(function(inv) {
        return (inv.Status==Status.PROCESSING
          || inv.Status==Status.PENDINGDOWNLOAD
          || inv.Status==Status.DOWNLOADFAILED);
      })
    }
    invoices.getPayingInvoices = function(list) {
      return list.filter(function(inv) {
        return (inv.Status==Status.PENDINGDOWNLOAD);
      })
    }
    invoices.getPaidInvoices = function(list) {
      return list.filter(function(inv) {
        return (inv.Status==Status.PAID);
      })
    }
    invoices.getDeletedInvoices = function(list) {
      return list.filter(function(inv) {
        return (inv.Status==Status.DELETED)
      })
    }

    invoices.isDownloading = function(inv) {
      return (inv.Status==Status.PENDINGDOWNLOAD
        || inv.Status==Status.DOWNLOADFAILED);
    }
    invoices.hasBeenSubmitted = function(inv) {
      return (inv.Status!=Status.DRAFT
        && inv.Status!=Status.DELETED);
    }
    invoices.hasBeenProcessed = function(inv) {
      return inv.Status!=Status.PROCESSED
            && inv.Status!=Status.PAID
    }
    invoices.isInSubmittableState = function(inv) {
      return inv.Status==Status.DRAFT
            || inv.Status==Status.DELETED
            || ((!invoices.hasBeenProcessed(inv)) && inv.MoreInfoRequested);
    }

    invoices.getInvoiceImages = function(invoiceId) {
      var deferred = $q.defer();
      deferred.resolve({data:[{type:'pdf'}]});
      return deferred.promise;
    }
  }


})();
